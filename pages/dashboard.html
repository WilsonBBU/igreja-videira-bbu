<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel | Igreja Videira BBU</title>
  <link rel="stylesheet" href="../assets/css/style.css">
  <script defer src="../assets/js/main.js"></script>
</head>

<body>

<header class="topbar">
  <div class="container wrap">
    <div class="brand">
      <h1>Igreja Videira BBU</h1>
      <small>Painel de acesso</small>
    </div>

    <button class="menu-toggle" onclick="document.body.classList.toggle('menu-open')">‚ò∞</button>

    <nav class="nav">
      <a href="../index.html">In√≠cio</a>
      <a href="biblioteca.html">Biblioteca</a>
      <a href="estudos.html">Sala de Estudos</a>
      <a href="#" onclick="logout()">Sair</a>
    </nav>
  </div>
</header>

<main class="container">

  <h2>Bem-vindo, <span id="nomeUsuario"></span>!</h2>

  <!-- ==== √ÅREA APENAS PARA O PASTOR ==== -->
  <section id="painelPastor" style="display:none; margin-top:35px;">
    <h3>Solicita√ß√µes de Cadastro</h3>

    <input type="text" id="busca" class="input-busca" placeholder="üîç Buscar por nome ou e-mail" onkeyup="filtrar()">

    <table class="tabela">
      <thead>
        <tr>
          <th>Nome</th>
          <th>E-mail</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="listaPendentes"></tbody>
    </table>
  </section>

  <!-- ==== √ÅREA PARA MEMBROS ==== -->
  <section id="painelMembro" style="margin-top:35px;">
    <h3>√Årea do Membro</h3>
    <p>Acesse conte√∫dos, devocionais, biblioteca e sala de estudos.</p>
  </section>

</main>

<footer class="footer">
  <div class="container center">
    ¬© <span id="year"></span> Igreja Videira BBU
  </div>
</footer>

<script>document.getElementById('year').textContent = new Date().getFullYear()</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const usuario = JSON.parse(localStorage.getItem("usuarioLogado"));
  if (!usuario) return window.location.href = "login.html";

  document.getElementById("nomeUsuario").textContent = usuario.nome;

  if (usuario.email === "videira.bbu@gmail.com") {
    document.getElementById("painelPastor").style.display = "block";
    carregarPendentes();
  } else {
    document.getElementById("painelMembro").style.display = "block";
  }
});

function carregarPendentes() {
  const contas = JSON.parse(localStorage.getItem("contas")) || [];
  const lista = document.getElementById("listaPendentes");
  lista.innerHTML = "";

  contas.forEach((c, index) => {
    if (!c.aprovado) {
      lista.innerHTML += `
      <tr>
        <td>${c.nome}</td>
        <td>${c.email}</td>
        <td>
          <button class="btn btn-primary" onclick="aprovar(${index})">Aprovar</button>
        </td>
      </tr>`;
    }
  });
}

function aprovar(i) {
  const contas = JSON.parse(localStorage.getItem("contas"));
  contas[i].aprovado = true;
  localStorage.setItem("contas", JSON.stringify(contas));
  carregarPendentes();
}

function filtrar() {
  const termo = document.getElementById("busca").value.toLowerCase();
  const linhas = document.querySelectorAll("#listaPendentes tr");

  linhas.forEach(linha => {
    linha.style.display = linha.innerText.toLowerCase().includes(termo) ? "" : "none";
  });
}

function logout() {
  localStorage.removeItem("usuarioLogado");
  window.location.href = "login.html";
}
</script>

</body>
</html>
